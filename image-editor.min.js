function cnimage_editor(e){const t=window.localStorage,i=void 0!==e&&void 0!==e.el&&document.querySelector(e.el),a=void 0===e||void 0===e.image_editor||e.image_editor,o=void 0!==e&&void 0!==e.browseFunct&&e.browseFunct,r=void 0!==e&&void 0!==e.displayImageFunct&&e.displayImageFunct,l=void 0!==e&&void 0!==e.editFunct&&e.editFunct,s=void 0!==e&&void 0!==e.deleteFunct&&e.deleteFunct,c=void 0!==e&&void 0!==e.saveFunct&&e.saveFunct,d=void 0!==e&&void 0!==e.resetFunct&&e.resetFunct,n=void 0!==e&&void 0!==e.closeFunct&&e.closeFunct,u=this,m=void 0!==e&&void 0!==e.width?e.width:300,p=void 0!==e&&void 0!==e.height?e.height:300,g=void 0!==e&&void 0!==e.cropbox_width?e.cropbox_width:150,v=void 0!==e&&void 0!==e.cropbox_height?e.cropbox_height:150,h=void 0===e||void 0===e.cropbox_resize||e.cropbox_resize,y=void 0!==e&&h&&"object"==typeof e.cropbox_resize&&void 0!==e.cropbox_resize.minwidth?e.cropbox_resize.minwidth:50,b=void 0!==e&&h&&"object"==typeof e.cropbox_resize&&void 0!==e.cropbox_resize.minheight?e.cropbox_resize.minheight:50,f=void 0!==e&&h&&"object"==typeof e.cropbox_resize&&void 0!==e.cropbox_resize.maxwidth?e.cropbox_resize.maxwidth:800,x=void 0!==e&&h&&"object"==typeof e.cropbox_resize&&void 0!==e.cropbox_resize.maxheight?e.cropbox_resize.maxheight:800,w=void 0!==e&&"object"==typeof e.autocrop&&e.autocrop,S=w&&"object"==typeof e.autocrop&&void 0!==e.autocrop.width?e.autocrop.width:50,q=w&&"object"==typeof e.autocrop&&void 0!==e.autocrop.height?e.autocrop.height:50,k=void 0!==e&&void 0!==e.imgcache&&e.imgcache;k&&"undefined"==t&&(console.log("Web Storage is not supported! image caching mechanism disabled"),k=!1),!k&&t&&t.setItem("imgeditorcachedb",[]);if(!i)return void console.log("Bind an element e.g. new cnimage_editor( {  el : <element> } )");let _=document.querySelector("body").getAttribute("data-imgeditor"),E={};return _?(E=JSON.parse(_)).push({$el:e.el,$image_editor:a,$browseFunct:o,$displayImageFunct:r,$editFunct:l,$deleteFunct:s,$saveFunct:c,$resetFunct:d,$closeFunct:n,$editor_width:m,$editor_height:p,$cropbox_width:g,$cropbox_height:v,$cropboxsave_width:S,$cropboxsave_height:q,$cropbox_resize:h,$cropbox_resize_minwidth:y,$cropbox_resize_minheight:b,$cropbox_resize_maxwidth:f,$cropbox_resize_maxheight:x,$autocrop:w,$cropboxsave_width:S,$cropboxsave_height:q,$imgcache:k,rawoptions:e}):E=[{$el:e.el,$editor:i,$image_editor:a,$browseFunct:o,$displayImageFunct:r,$editFunct:l,$deleteFunct:s,$saveFunct:c,$resetFunct:d,$closeFunct:n,$editor_width:m,$editor_height:p,$cropbox_width:g,$cropbox_height:v,$cropboxsave_width:S,$cropboxsave_height:q,$cropbox_resize:h,$cropbox_resize_minwidth:y,$cropbox_resize_minheight:b,$cropbox_resize_maxwidth:f,$cropbox_resize_maxheight:x,$autocrop:w,$cropboxsave_width:S,$cropboxsave_height:q,$imgcache:k,rawoptions:e}],document.querySelector("body").setAttribute("data-imgeditor",JSON.stringify(E)),this.init=function(){null==document.querySelector("#image-editor-modal")&&a&&this.initModalEditor(),i.style.width=m+"px",i.style.height=p+"px",i.classList.add("image-editor");var e=document.querySelectorAll(".image-editor").length-1;if(i.setAttribute("data-index",e),null==i.querySelector("input.filetype")&&null==i.querySelector("input.filename")&&null==i.querySelector("input.image-src")&&(i.innerHTML='<input type="hidden" name="image['+e+'][filetype]" class="filetype"><input type="hidden" name="image['+e+'][filename]" class="filename"><input type="hidden" name="image['+e+'][contents]" class="image_src"><input class="file-browse" type="file" accept="image/x-png,image/jpeg,image/png" style="display:none;"><div class="image-editor-tools"><a href="javascript:void(0);" class="image-editor-browse flex-center radius-5"><i class="fas fa-plus"></i></a><a href="javascript:void(0);" class="image-editor-edit flex-center radius-5"><i class="fas fa-magic"></i></a><a href="javascript:void(0);" class="image-editor-delete flex-center radius-5"><i class="far fa-trash-alt"></i></a></div><div class="image-editor-preview"></div>'),i.querySelector(".image-editor-browse").style.display="flex",""!=i.querySelector("input.filetype")&&""!=i.querySelector("input.filename").value&&""!=i.querySelector("input.image_src").value?(i.querySelector(".image-editor-edit").style.display="flex",i.querySelector(".image-editor-delete").style.display="flex",document.querySelectorAll(".image-editor").forEach(function(e){e.classList.remove("active")}),i.classList.add("active"),this.displayImage(!1,i.querySelector("input.image_src").value)):(i.querySelector(".image-editor-edit").style.display="none",i.querySelector(".image-editor-delete").style.display="none"),i.querySelector(".image-editor-browse").addEventListener("click",function(e){e.preventDefault();let t=document.querySelector(".image-editor.active");null!=t&&t.classList.remove("active"),this.closest(".image-editor").classList.add("active"),i.querySelector("input.file-browse").click(),o&&window[o]()}),i.querySelector(".image-editor-edit").addEventListener("click",function(e){if(e.preventDefault(),null!=document.querySelector("#image-editor-modal")&&a){let e=document.querySelector(".image-editor.active");null!=e&&e.classList.remove("active"),this.closest(".image-editor").classList.add("active"),document.querySelector("#image-editor-modal").style.display="block",a?u.displayImageModal(document.querySelector(".image-editor.active input.image_src").value,!0):alert("Editor not found!")}else alert("Editor not found!");l&&window[l](document.querySelector(".image-editor.active"))}),i.querySelector(".image-editor-delete").addEventListener("click",function(e){e.preventDefault();let a=document.querySelector(".image-editor.active");if(null!=a&&a.classList.remove("active"),this.closest(".image-editor").classList.add("active"),null!=this.closest(".image-editor").querySelector("canvas")&&this.closest(".image-editor").querySelector("canvas").remove(),null!=this.closest(".image-editor").querySelector("img")&&this.closest(".image-editor").querySelector("img").remove(),this.style.display="none",this.closest(".image-editor").querySelector(".image-editor-edit").style.display="none",this.closest(".image-editor").querySelector("input.file-browse").value="",this.closest(".image-editor").querySelector("input.image_src").value="",this.closest(".image-editor").querySelector("input.filename").value="",this.closest(".image-editor").querySelector("input.filetype").value="",k){var o=t.getItem("imgeditorcachedb");if(o){var r=(o=JSON.parse(o)).findIndex(function(e){return e.index==i.getAttribute("data-index")});-1!=r&&o.splice(r,1),t.setItem("imgeditorcachedb",JSON.stringify(o))}}s&&window[s](document.querySelector(".image-editor.active"))}),i.querySelector("input.file-browse").addEventListener("change",function(){var e=this.value.lastIndexOf(".")+1,t=this.value.substr(e,this.value.length).toLowerCase();"jpg"==t||"jpeg"==t||"png"==t?u.ValidateSize(this)&&u.displayImage(this):alert("Only jpg/jpeg and png files are allowed!")}),k&&t.getItem("imgeditorcachedb")){var r=JSON.parse(t.getItem("imgeditorcachedb")),c=r.findIndex(function(e){return e.index==i.getAttribute("data-index")});document.querySelectorAll(".image-editor").forEach(function(e){e.classList.remove("active")}),i.classList.add("active"),-1!=c&&(u.displayImage(!1,r[c].dataurl),i.querySelector("input.filetype").value=r[c].filetype,i.querySelector("input.filename").value=r[c].filename,i.querySelector("input.image_src").value=r[c].dataurl)}},this.cropCanvas=function(){null!=document.querySelector("#image-editor-modal #crop-box")&&Caman("#modal-canvas",function(){let e=document.querySelector("#image-editor-modal #crop-box").offsetWidth,t=document.querySelector("#image-editor-modal #crop-box").offsetHeight,i=document.querySelector("#image-editor-modal #crop-box").offsetTop,a=document.querySelector("#image-editor-modal #crop-box").offsetLeft;this.crop(e,t,a,i),this.render(function(){document.querySelector("#image-editor-modal canvas").setAttribute("id","modal-canvas"),document.querySelector("#image-editor-modal #crop-box").remove()})})},this.initModalEditor=function(){let e=document.createElement("div");e.setAttribute("id","image-editor-modal"),e.innerHTML='<div id="image-editor-body"><div id="image-editor-toolbox"> <ul class="p00 m00 list-style-none"> <li class="list-style-none align-left display-table toolbox-li"> <a href="javascript:void(0);" id="image-editor-modal-save" class="display-block toolbox m5"> <i class="fas fa-check mr5"></i>Save </a> </li><li class="list-style-none align-left display-table toolbox-li"> <a href="javascript:void(0);" id="image-editor-modal-close" class="display-block toolbox m5 toolbox-dp-trigger"> <i class="fas fa-times mr5"></i>Cancel </a> </li><li class="list-style-none align-left display-table toolbox-li"> <a href="javascript:void(0);" id="image-editor-modal-reset" class="display-block toolbox m5 toolbox-dp-trigger"> <i class="fas fa-sync mr5"></i>Reset </a> </li><li class="list-style-none align-left display-table toolbox-li"> <a href="javascript:void(0);" class="display-block toolbox m5 toolbox-dp-trigger"> <i class="fas fa-magic mr5"></i>Adjust </a> <div class="toolbox-sub bg-white box-shadow"> <ul class="p00 m00"> <li class="filter-slider"> <label class="full-width display-block">Brightness <span class="filter-range">0</span></label> <input type="range" min="-100" max="100" value="0" class="slider filter-range-input mb5" data-filter="brightness"> </li><li class="filter-slider"> <label class="full-width display-block">Contrast <span class="filter-range">0</span></label> <input type="range" min="-100" max="100" value="0" class="slider filter-range-input mb5" data-filter="contrast"> </li><li class="filter-slider"> <label class="full-width display-block">Saturation <span class="filter-range">0</span></label> <input type="range" min="-100" max="100" value="0" class="slider filter-range-input mb5" data-filter="saturation"> </li><li class="filter-slider"> <label class="full-width display-block">Vibrance <span class="filter-range">0</span></label> <input type="range" min="-100" max="100" value="0" class="slider filter-range-input mb5" data-filter="vibrance"> </li><li class="filter-slider"> <label class="full-width display-block">Exposure <span class="filter-range">0</span></label> <input type="range" min="-100" max="100" value="0" class="slider filter-range-input mb5" data-filter="exposure"> </li><li class="filter-slider"> <label class="full-width display-block">Clip <span class="filter-range">0</span></label> <input type="range" min="-100" max="100" value="0" class="slider filter-range-input mb5" data-filter="clip"> </li><li class="filter-slider"> <label class="full-width display-block">Hue <span class="filter-range">0</span></label> <input type="range" min="-100" max="100" value="0" class="slider filter-range-input mb5" data-filter="hue"> </li><li class="filter-slider"> <label class="full-width display-block">Sepia <span class="filter-range">0</span></label> <input type="range" min="-100" max="100" value="0" class="slider filter-range-input mb5" data-filter="sepia"> </li><li class="filter-slider"> <label class="full-width display-block">Noise <span class="filter-range">0</span></label> <input type="range" min="-100" max="100" value="0" class="slider filter-range-input mb5" data-filter="noise"> </li><li class="filter-slider"> <label class="full-width display-block">Sharpen <span class="filter-range">0</span></label> <input type="range" min="-100" max="100" value="0" class="slider filter-range-input mb5" data-filter="sharpen"> </li><li class="filter-slider"> <label class="full-width display-block">StackBlur <span class="filter-range">0</span></label> <input type="range" min="-100" max="100" value="0" class="slider filter-range-input mb5" data-filter="stackBlur"> </li></ul> </div></li><li class="list-style-none align-left display-table toolbox-li"> <a href="javascript:void(0);" class="display-block toolbox m5 toolbox-dp-trigger"> <i class="fas fa-magic mr5"></i>Presets </a> <div class="toolbox-sub bg-white box-shadow"> <ul class="p00 m00" id="image-editor-presets"> <li> <a href="javascript:void(0);" data-preset="vintage">Vintage</a></li><li> <a href="javascript:void(0);" data-preset="lomo">Lomo</a></li><li> <a href="javascript:void(0);" data-preset="clarity">Clarity</a></li><li> <a href="javascript:void(0);" data-preset="sinCity">Sin City</a></li><li> <a href="javascript:void(0);" data-preset="sunrise">Sunrise</a></li><li> <a href="javascript:void(0);" data-preset="crossProcess">Cross Process</a></li><li> <a href="javascript:void(0);" data-preset="orangePeel">Orange Peel</a></li><li> <a href="javascript:void(0);" data-preset="love">Love</a></li><li> <a href="javascript:void(0);" data-preset="grungy">Grungy</a></li><li> <a href="javascript:void(0);" data-preset="jarques">Jarques</a></li><li> <a href="javascript:void(0);" data-preset="pinhole">Pinhole</a></li><li> <a href="javascript:void(0);" data-preset="oldBoot">Old Boot</a></li><li> <a href="javascript:void(0);" data-preset="glowingSun">Glowing Sun</a></li><li> <a href="javascript:void(0);" data-preset="hazyDays">Hazy Days</a></li><li> <a href="javascript:void(0);" data-preset="herMajesty">Her Majesty</a></li><li> <a href="javascript:void(0);" data-preset="nostalgia">Nostalgia</a></li><li> <a href="javascript:void(0);" data-preset="hemingway">Hemingway</a></li><li> <a href="javascript:void(0);" data-preset="concentrate">concentrate</a></li></ul> </div></li><li class="list-style-none align-left display-table toolbox-li"> <a href="javascript:void(0);" class="display-block toolbox m5"> <i class="fas fa-expand-arrows-alt mr5"></i>Resize </a> <div class="toolbox-sub bg-white box-shadow"><div class="col-xs-6 mb5 pl3 pr3"><label class="full-width display-block">Width:</label><input type="number" class="mb00" id="resize-width" name="resize_width"></div><div class="col-xs-6 mb5 pl3 pr3"><label class="full-width display-block">Height:</label><input type="number" class="mb00" id="resize-height" name="resize_height"></div><div class="col-xs-12 col-sm-12 mt8 pl3 pr3"><a href="javascript:void(0);" class="btn btn-block btn-sm btn-filled mb8" id="resize-save">Resize</a></div></div></li><li class="list-style-none align-left display-table toolbox-li"> <a href="javascript:void(0);" id="image-editor-crop" class="display-block toolbox m5"> <i class="fas fa-crop-alt mr5"></i>Crop </a> </li><li class="list-style-none align-left display-table toolbox-li" style="display:none"> <a href="javascript:void(0);" id="image-editor-crop-now" class="bg-success display-block toolbox m5"> <i class="fas fa-check mr5"></i>Crop </a> </li><li class="list-style-none align-left display-table toolbox-li"> <a href="javascript:void(0);" id="image-editor-rotate" class="display-block toolbox m5"> <i class="fas fa-undo mr5"></i>Rotate </a> <div class="toolbox-sub bg-white box-shadow"> <ul class="p00 m00" id="image-editor-rotate"> <li> <a href="javascript:void(0);" data-rotate="cw">Clock wise</a></li><li> <a href="javascript:void(0);" data-rotate="ccw">Counter clock wise</a></li></ul></div></li></ul></div><div id="image-editor-canvas"><div id="canvas-holder" width=""></div></div></div>',document.querySelector("body").appendChild(e),document.querySelector("#image-editor-modal #image-editor-modal-close").addEventListener("click",function(e){e.preventDefault(),document.querySelector("#image-editor-modal").style.display="none",document.querySelector("#image-editor-modal canvas").style.display="none",document.querySelector("body").style.overflowY="auto",u.reset(),n&&window[n]()}),document.querySelector("#image-editor-modal #image-editor-modal-save").addEventListener("click",function(e){e.preventDefault();let a=document.querySelector("#image-editor-modal #canvas-holder canvas");a.width,u.getActiveEditorOptions().$cropboxsave_width,a.height,u.getActiveEditorOptions().$cropboxsave_height;Caman("#modal-canvas",function(){this.render(function(){var e=document.querySelector("#image-editor-modal canvas").offsetWidth,a=document.querySelector("#image-editor-modal canvas").offsetHeight;document.querySelector("#image-editor-modal").style.display="none",null!=document.querySelector(".image-editor.active canvas")&&document.querySelector(".image-editor.active canvas").remove(),null!=document.querySelector(".image-editor.active img")&&document.querySelector(".image-editor.active img").remove();var o=document.createElement("canvas");document.querySelector(".image-editor.active").appendChild(o),null!=document.querySelector(".image-editor.active img")&&document.querySelector(".image-editor.active .image-editor-preview").appendChild(o);var r=document.querySelector(".image-editor.active canvas").getContext("2d");if(r.canvas.width=e,r.canvas.height=a,r.drawImage(document.querySelector("#image-editor-modal canvas"),0,0),document.querySelector(".image-editor.active input.image_src").value=document.querySelector(".image-editor.active canvas").toDataURL(),k)if(s=t.getItem("imgeditorcachedb")){var l=(s=JSON.parse(s)).findIndex(function(e){return e.index==i.getAttribute("data-index")});-1!=l?s[l].dataurl=document.querySelector(".image-editor.active input.image_src").value:s.push({index:document.querySelector(".image-editor.active").getAttribute("data-index"),dataurl:document.querySelector(".image-editor.active input.image_src").value,filetype:document.querySelector(".image-editor.active input.filetype").value,filename:document.querySelector(".image-editor.active input.filename").value}),t.setItem("imgeditorcachedb",JSON.stringify(s))}else{var s;(s=[]).push({index:document.querySelector(".image-editor.active").getAttribute("data-index"),dataurl:document.querySelector(".image-editor.active input.image_src").value,filetype:document.querySelector(".image-editor.active input.filetype").value,filename:document.querySelector(".image-editor.active input.filename").value}),t.setItem("imgeditorcachedb",JSON.stringify(s))}})}),document.querySelector("body").style.overflowY="auto",c&&window[c](document.querySelector(".image-editor.active"))}),document.querySelector("#image-editor-modal #image-editor-crop").addEventListener("click",function(e){let t=document.createElement("div");t.setAttribute("id","crop-box"),t.style.width=g+"px",t.style.height=v+"px",t.innerHTML='<div class="resizer" style="position:absolute;top:-2px;left:-2px;border-top: 3px solid #FFF;border-left: 3px solid #FFF;display: block;width: 15px;height: 15px;"></div><div class="resizer" style="position:absolute;top:-2px;right:-2px;border-top: 3px solid #FFF;border-right: 3px solid #FFF;display: block;width: 15px;height: 15px;"></div><div class="resizer" style="position:absolute;bottom:-2px;left:-2px;border-bottom: 3px solid #FFF;border-left: 3px solid #FFF;display: block;width: 15px;height: 15px;"></div><div class="resizer" style="position:absolute;bottom:-2px;right:-2px;border-bottom: 3px solid #FFF;border-right: 3px solid #FFF;display: block;width: 15px;height: 15px;"></div>',document.querySelector("#image-editor-modal #image-editor-canvas #canvas-holder").appendChild(t),u.dragCropBox(),u.resizeCropBox(),this.closest("li").style.display="none",document.querySelector("#image-editor-modal #image-editor-crop-now").closest("li").style.display="block"}),document.querySelector("#image-editor-modal #image-editor-crop-now").addEventListener("click",function(e){u.cropCanvas(),this.closest("li").style.display="none",document.querySelector("#image-editor-modal #image-editor-crop").closest("li").style.display="block"}),document.querySelectorAll(".filter-slider").forEach(function(e){e.querySelector(".filter-range").textContent=e.querySelector(".filter-range-input").value,e.querySelector(".filter-range-input").addEventListener("input",function(){this.closest(".filter-slider").querySelector(".filter-range").textContent=this.value,u.applyFilter(this.getAttribute("data-filter"),this.value)})}),document.querySelectorAll("#image-editor-modal #image-editor-presets li a").forEach(function(e){e.addEventListener("click",function(t){t.preventDefault(),u.applyPreset(e.getAttribute("data-preset"))}),document.querySelectorAll(".toolbox-sub").forEach(function(e){e.style.display="none"})}),document.querySelectorAll("#image-editor-modal #image-editor-rotate li a").forEach(function(e){e.addEventListener("click",function(t){t.preventDefault(),u.applyRotate(e.getAttribute("data-rotate"))}),document.querySelectorAll(".toolbox-sub").forEach(function(e){e.style.display="none"})}),document.querySelector("#image-editor-modal #image-editor-modal-reset").addEventListener("click",function(e){e.preventDefault(),u.reset(),d&&window[d](document.querySelector(".image-editor.active"))}),document.querySelector("#image-editor-modal #resize-save").addEventListener("click",function(e){e.preventDefault();let t=this.closest(".toolbox-sub").querySelector("#resize-width").value,i=this.closest(".toolbox-sub").querySelector("#resize-height").value;u.applyResize(t,i)})},this.dragCropBox=function(){let e,t,i,a,o=document.querySelector("#image-editor-modal #crop-box"),r=document.querySelector("#image-editor-modal #image-editor-canvas #canvas-holder"),l=!1,s=0,c=0;function d(e){"touchstart"===e.type?(i=e.touches[0].clientX-s,a=e.touches[0].clientY-c):(i=e.clientX-s,a=e.clientY-c),e.target===o&&(l=!0)}function n(o){i=e,a=t,l=!1}function u(r){var d,n,u;l&&(r.preventDefault(),"touchmove"===r.type?(e=r.touches[0].clientX-i,t=r.touches[0].clientY-a):(e=r.clientX-i,t=r.clientY-a),s=e,c=t,d=e,n=t,(u=o).style.top=n+"px",u.style.left=d+"px")}r.addEventListener("touchstart",d,!1),r.addEventListener("touchend",n,!1),r.addEventListener("touchmove",u,!1),r.addEventListener("mousedown",d,!1),r.addEventListener("mouseup",n,!1),r.addEventListener("mousemove",u,!1)},this.checkIfMobile=function(){return!(!/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)&&!/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))},this.ValidateSize=function(e){if(!(e.files[0].size/1024/1024>2))return!0;alert("File size exceeds 2 MB")},this.getActiveEditorOptions=function(){let e=JSON.parse(document.querySelector("body").getAttribute("data-imgeditor"));return e[e.findIndex(function(e){return e.$el=="#"+document.querySelector(".image-editor.active").getAttribute("id")})]},this.resizeCropBox=function(){let e=document.querySelectorAll("#image-editor-modal #image-editor-canvas #crop-box .resizer"),t=document.querySelector("#image-editor-modal #image-editor-canvas #crop-box");var i,a,o,r;function l(e){u.getActiveEditorOptions().$cropbox_resize&&(u.checkIfMobile()?(i=e.touches[0].clientX,a=e.touches[0].clientY):(i=e.clientX,a=e.clientY),o=parseInt(document.defaultView.getComputedStyle(t).width,10),r=parseInt(document.defaultView.getComputedStyle(t).height,10),u.checkIfMobile()?(document.documentElement.addEventListener("touchmove",s,!1),document.documentElement.addEventListener("touchend",c,!1)):(document.documentElement.addEventListener("mousemove",s,!1),document.documentElement.addEventListener("mouseup",c,!1)),document.documentElement.addEventListener("touchmove",s,!1),document.documentElement.addEventListener("touchend",c,!1))}function s(e){u.checkIfMobile()?(o+e.touches[0].clientX-i<u.getActiveEditorOptions().$cropbox_resize_maxwidth&&o+e.touches[0].clientX-i>u.getActiveEditorOptions().$cropbox_resize_minwidth&&(t.style.width=o+e.touches[0].clientX-i+"px"),r+e.touches[0].clientY-a<u.getActiveEditorOptions().$cropbox_resize_maxheight&&r+e.touches[0].clientY-a>u.getActiveEditorOptions().$cropbox_resize_minheight&&(t.style.height=r+e.touches[0].clientY-a+"px")):(o+e.clientX-i<u.getActiveEditorOptions().$cropbox_resize_maxwidth&&o+e.clientX-i>u.getActiveEditorOptions().$cropbox_resize_minwidth&&(t.style.width=o+e.clientX-i+"px"),r+e.clientY-a<u.getActiveEditorOptions().$cropbox_resize_maxheight&&r+e.clientY-a>u.getActiveEditorOptions().$cropbox_resize_minheight&&(t.style.height=r+e.clientY-a+"px"))}function c(e){u.checkIfMobile()?(document.documentElement.removeEventListener("touchmove",s,!1),document.documentElement.removeEventListener("touchend",c,!1)):(document.documentElement.removeEventListener("mousemove",s,!1),document.documentElement.removeEventListener("mouseup",c,!1))}e.forEach(function(e){u.checkIfMobile()?e.addEventListener("touchstart",l,!1):e.addEventListener("mousedown",l,!1)})},this.displayImage=function(e,t){if(!(t="undefined"!=t&&t)&&"undefined"==e.files&&"undefined"==!e.files[0])return!1;null!=document.querySelector(".image-editor.active canvas")&&document.querySelector(".image-editor.active canvas").remove(),null!=document.querySelector(".image-editor.active img")&&document.querySelector(".image-editor.active img").remove();let o=document.createElement("canvas");o.style.display="none",document.querySelector(".image-editor.active .image-editor-preview").appendChild(o);let l=document.querySelector(".image-editor.active canvas").getContext("2d"),s=new Image;s.crossOrigin="anonymous",s.onload=function(){if(l.canvas.width=this.width,l.canvas.height=this.height,l.drawImage(s,0,0),i.setAttribute("data-imgw",s.width),i.setAttribute("data-imgh",s.height),!t){let t=(this.width-u.getActiveEditorOptions().$cropboxsave_width)/2,i=(this.height-u.getActiveEditorOptions().$cropboxsave_height)/2;Caman(".image-editor.active canvas",function(){w?this.crop(u.getActiveEditorOptions().$cropboxsave_width,u.getActiveEditorOptions().$cropboxsave_height,t,i):this.crop(s.width,s.height,0,0),this.render(function(){document.querySelector(".image-editor.active input.image_src").value=document.querySelector(".image-editor.active canvas").toDataURL(),document.querySelector(".image-editor.active input.filename").value=e.files[0].name,document.querySelector(".image-editor.active input.filetype").value=document.querySelector(".image-editor.active input.filename").value.split(".")[1]}),r&&window[r](document.querySelector(".image-editor.active"))})}null!=document.querySelector("#image-editor-modal")&&a?document.querySelector(".image-editor.active .image-editor-edit").style.display="flex":document.querySelector(".image-editor.active .image-editor-edit").style.display="none",document.querySelector(".image-editor.active .image-editor-delete").style.display="flex",o.style.display="block"},s.src=t||URL.createObjectURL(e.files[0])},this.displayImageModal=function(e,t){null!=document.querySelector("#image-editor-modal #image-editor-canvas canvas")&&document.querySelector("#image-editor-modal #image-editor-canvas canvas").remove();let i=document.createElement("canvas");i.setAttribute("id","modal-canvas"),document.querySelector("#image-editor-modal #image-editor-canvas #canvas-holder").appendChild(i),u.cloneImg(e,t);let a=document.querySelector("#image-editor-modal #image-editor-canvas canvas").getContext("2d"),o=new Image;o.crossOrigin="anonymous",t?(o.onload=u.drawImageScaled.bind(null,o,a),o.src=document.querySelector(".image-editor.active input.image_src").value):e.files&&e.files[0]&&(o.onload=u.drawImageScaled.bind(null,o,a),o.src=URL.createObjectURL(e.files[0]))},this.cloneImg=function(e,t){if(null!=document.querySelector("#clone-img")&&document.querySelector("#clone-img").remove(),t){var i=document.createElement("div");i.setAttribute("id","clone-img"),i.innerHTML='<img src="'+e+'">',document.querySelector("body").style.overflowY="hidden",document.querySelector("body").appendChild(i)}else{var a=new FileReader;a.onload=function(e){var t=document.createElement("div");t.setAttribute("id","clone-img"),t.innerHTML='<img src="'+e.target.result+'">',document.querySelector("body").style.overflowY="hidden",document.querySelector("body").appendChild(t)},a.readAsDataURL(e.files[0])}},this.drawImageScaled=function(e,t){t.canvas.width=document.querySelector("#clone-img img").offsetWidth,t.canvas.height=document.querySelector("#clone-img img").offsetHeight;var i=t.canvas,a=i.width/e.width,o=i.height/e.height,r=Math.min(a,o),l=(i.width-e.width*r)/2,s=(i.height-e.height*r)/2;t.clearRect(0,0,i.width,i.height),t.drawImage(e,0,0,e.width,e.height,l,s,e.width*r,e.height*r),document.querySelector("#image-editor-modal canvas").style.display="block"},this.reset=function(){null!=document.querySelector("#clone-img")&&document.querySelector("#clone-img").remove(),null!=document.querySelector("#image-editor-modal #crop-box")&&document.querySelector("#image-editor-modal #crop-box").remove(),document.querySelectorAll(".filter-range-input").forEach(function(e){e.value=0}),document.querySelector("#image-editor-modal #image-editor-crop-now").closest("li").style.display="none",document.querySelector("#image-editor-modal #image-editor-crop").closest("li").style.display="block",u.displayImageModal(document.querySelector(".image-editor.active input.file-browse"),!1)},this.applyResize=function(e,t){Caman("#image-editor-modal canvas",function(){this.resize({width:e,height:t}),this.render()})},this.applyFilter=function(e,t){let i=e.replace("filter-","");Caman("#image-editor-modal canvas",function(){switch(this.revert(!1),i){case"brightness":this.brightness(t).render();break;case"contrast":this.contrast(t).render();break;case"contrast":this.saturation(t).render();break;case"vibrance":this.contrast(t).render();break;case"exposure":this.exposure(t).render();break;case"clip":case"clip":this.clip(t).render();break;case"hue":this.hue(t).render();break;case"sepia":this.sepia(t).render();break;case"noise":this.noise(t).render();break;case"sharpen":this.vintage(t).render();break;case"stackBlur":this.stackBlur(t).render()}})},this.applyPreset=function(e){Caman("#image-editor-modal canvas",function(){switch(this.revert(!1),e){case"vintage":this.vintage().render();break;case"lomo":this.lomo().render();break;case"clarity":this.clarity().render();break;case"sinCity":this.sinCity().render();break;case"sunrise":this.sunrise().render();break;case"crossProcess":this.crossProcess().render();break;case"orangePeel":this.orangePeel().render();break;case"love":this.love().render();break;case"grungy":this.grungy().render();break;case"jarques":this.jarques().render();break;case"pinhole":this.pinhole().render();break;case"oldBoot":this.oldBoot().render();break;case"glowingSun":this.glowingSun().render();break;case"hazyDays":this.hazyDays().render();break;case"herMajesty":this.herMajesty().render();break;case"nostalgia":this.nostalgia().render();break;case"hemingway":case"hemingway":this.hemingway().render()}document.querySelectorAll(".toolbox-sub").forEach(function(e){e.style.display="none"})})},this.applyRotate=function(e){Caman("#image-editor-modal canvas",function(){switch(e){case"cw":this.rotate(90).render();break;case"ccw":this.rotate(-90).render()}document.querySelectorAll(".toolbox-sub").forEach(function(e){e.style.display="none"}),u.redisplayImageModal(this.toBase64())})},this.redisplayImageModal=function(e){null!=document.querySelector("#image-editor-modal #image-editor-canvas canvas")&&document.querySelector("#image-editor-modal #image-editor-canvas canvas").remove();let t=document.createElement("canvas");t.setAttribute("id","modal-canvas"),document.querySelector("#image-editor-modal #image-editor-canvas #canvas-holder").appendChild(t),u.cloneImg(e,!0);let i=document.querySelector("#image-editor-modal #image-editor-canvas canvas").getContext("2d"),a=new Image;a.crossOrigin="anonymous",a.onload=u.drawImageScaled.bind(null,a,i),a.src=e},this.isHidden=function(e){let t=window.getComputedStyle(e);return"none"===t.display||"hidden"===t.visibility},this.init(e)}